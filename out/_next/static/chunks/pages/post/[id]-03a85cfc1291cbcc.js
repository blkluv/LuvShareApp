(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7687],{23208:function(e,l,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/post/[id]",function(){return t(18033)}])},7355:function(e,l,t){"use strict";t.d(l,{Z:function(){return p}});var n=t(85893),o=t(67294),i=t(73359),r=t(50319),s=t(76781),a=t(39321),d=t(15209),c=t(54524),u=t(86501),x=t(12313);let v=()=>(0,n.jsx)(x.NL.Custom,{children:e=>{var l;let{account:t,chain:o,openAccountModal:i,openChainModal:r,openConnectModal:s,authenticationStatus:a,mounted:d}=e,c=d&&"loading"!==a;return(0,n.jsx)("div",{...!c&&{"aria-hidden":!0,style:{opacity:0,pointerEvents:"none",userSelect:"none"}},children:c&&t&&o&&(!a||"authenticated"===a)?o.unsupported?(0,n.jsx)("button",{onClick:r,type:"button",children:"Wrong network"}):(0,n.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,n.jsxs)("button",{onClick:r,style:{display:"flex",alignItems:"center"},type:"button",children:[o.hasIcon&&(0,n.jsx)("div",{style:{background:o.iconBackground,width:12,height:12,borderRadius:999,overflow:"hidden",marginRight:4},children:o.iconUrl&&(0,n.jsx)("img",{alt:null!==(l=o.name)&&void 0!==l?l:"Chain icon",src:o.iconUrl,style:{width:12,height:12}})}),o.name]}),(0,n.jsxs)("button",{onClick:i,type:"button",children:[t.displayName,t.displayBalance?" (".concat(t.displayBalance,")"):""]})]}):(0,n.jsx)("button",{onClick:s,type:"button",children:"Get Started..."})})}}),m=()=>{let e=(0,d.qr)(e=>e.setProfiles),l=(0,d.qr)(e=>e.setCurrentProfile),t=(0,d.Fc)(e=>e.setProfileId),[x,m]=(0,o.useState)(!1),{chain:p}=(0,c.LN)(),{switchNetwork:h}=(0,c.g0)(),[f,g]=(0,o.useState)(!1),{address:j,connector:y}=(0,c.mA)(),{connectors:b,error:w,connectAsync:N}=(0,c.$4)(),{signMessageAsync:C,isLoading:S}=(0,c.QW)(),[k,{error:F,loading:P}]=(0,i.t)(s.bT,{fetchPolicy:"no-cache"}),[Z,{error:E,loading:I}]=(0,r.D)(s.bs),[T,{error:R,loading:q}]=(0,i.t)(s.$);(0,o.useEffect)(()=>{m(!0)},[]);let A=async()=>{try{var n,o,i,r,s,a,d,c,x;let v=await k({variables:{request:{address:j}}});if(!(null==v?void 0:null===(n=v.data)||void 0===n?void 0:null===(o=n.challenge)||void 0===o?void 0:o.text))return u.ZP.error("ERROR_MESSAGE");let m=await C({message:null==v?void 0:null===(i=v.data)||void 0===i?void 0:null===(r=i.challenge)||void 0===r?void 0:r.text}),p=await Z({variables:{request:{address:j,signature:m}}});localStorage.setItem("accessToken",null===(s=p.data)||void 0===s?void 0:s.authenticate.accessToken),localStorage.setItem("refreshToken",null===(a=p.data)||void 0===a?void 0:a.authenticate.refreshToken);let{data:h}=await T({variables:{request:{ownedBy:[j]}}});if((null==h?void 0:null===(d=h.profiles)||void 0===d?void 0:null===(c=d.items)||void 0===c?void 0:c.length)===0)return u.ZP.error("You have no lens profile yet, please create one");{let f=null==h?void 0:null===(x=h.profiles)||void 0===x?void 0:x.items,g=f[0];e(f),l(g),t(g.id)}}catch(y){}};return(null==y?void 0:y.id)?(0,n.jsx)("div",{className:"flex flex-1",children:(null==p?void 0:p.id)===a.Kj?(0,n.jsx)("button",{className:"flex-1",onClick:()=>A(),children:x?"Log In With Lens":""}):(0,n.jsx)("button",{className:"flex-1",onClick:()=>{h?h(a.Kj):u.ZP.error("Please change your network!")},children:"Switch Network"})}):(0,n.jsx)("div",{className:"flex flex-1",children:(0,n.jsx)(v,{})})};var p=m},33944:function(e,l,t){"use strict";var n=t(85893),o=t(72329),i=t(67294),r=t(21273),s=t(58533),a=t(9747),d=t(25675),c=t.n(d),u=t(15209),x=t(41664),v=t.n(x),m=t(29451),p=t(9507),h=t(5276);let f=e=>{var l,t,d;let{profile:x}=e,g={profileId:x,limit:30},{data:j,loading:y,error:b,fetchMore:w}=(0,r.cN)({variables:{request:g},skip:!x}),N=null==j?void 0:null===(l=j.followers)||void 0===l?void 0:l.items,C=null==j?void 0:null===(t=j.followers)||void 0===t?void 0:t.pageInfo;(0,u.qr)(e=>e.currentProfile);let[S,k]=(0,i.useState)("followers"),{observe:F}=(0,h.Y)({onEnter:async()=>{await w({variables:{request:{cursor:null==C?void 0:C.next,...g}}})}});if(y)return(0,n.jsx)(a.Z,{message:"Loading followers"});if((null==N?void 0:N.length)===0)return(0,n.jsx)("div",{className:"p-5",children:"No Followers"});let P=null==j?void 0:j.followers.items;return console.log("Followers",f),(0,n.jsx)("div",{className:"overflow-y-auto max-h-[80vh]",id:"scrollableDiv",children:(0,n.jsx)(s.Z,{dataLength:null!==(d=null==N?void 0:N.length)&&void 0!==d?d:0,next:()=>{},hasMore:!0,loader:(null==C?void 0:C.next)&&(0,n.jsx)("span",{ref:F,className:"flex justify-center p-10",children:(0,n.jsx)(p.Z,{})}),endMessage:(0,n.jsx)("p",{style:{textAlign:"center"},children:(0,n.jsx)("b",{children:"Yay! You have seen it all"})}),children:(0,n.jsx)("div",{children:null==P?void 0:P.map(e=>{var l,t,i,r,s,a,d,u,x;return(0,n.jsx)(v(),{href:"/u/".concat(null==e?void 0:null===(l=e.wallet)||void 0===l?void 0:null===(t=l.defaultProfile)||void 0===t?void 0:t.id),children:(0,n.jsxs)("div",{className:"flex gap-3 hover:bg-primary p-2 cursor-pointer font-semibold rounded items-center",children:[(0,n.jsx)("div",{className:"relative h-[32px] w-[32px]",children:(0,n.jsx)(c(),{src:(0,o.Z)(null==e?void 0:null===(i=e.wallet)||void 0===i?void 0:i.defaultProfile),alt:"profilepic",className:"rounded-full",layout:"fill"})}),(0,n.jsx)("div",{}),(0,n.jsx)("p",{className:"flex gap-1 items-center text-md font-bold text-primary lowercase",children:null==e?void 0:null===(r=e.wallet)||void 0===r?void 0:null===(s=r.defaultProfile)||void 0===s?void 0:s.name}),(0,n.jsxs)("p",{prefix:"@",className:"capitalize text-gray-400 text-xs",children:[(0,m.Z)(null==e?void 0:null===(a=e.wallet)||void 0===a?void 0:null===(d=a.defaultProfile)||void 0===d?void 0:d.handle)," ",""]})]})},null==e?void 0:null===(u=e.wallet)||void 0===u?void 0:null===(x=u.defaultProfile)||void 0===x?void 0:x.id)})})})})};l.Z=f},30034:function(e,l,t){"use strict";var n=t(85893),o=t(72329),i=t(67294),r=t(21273),s=t(58533),a=t(9747),d=t(15209),c=t(29451),u=t(41664),x=t.n(u),v=t(25675),m=t.n(v),p=t(9507),h=t(5276);let f=e=>{var l,t,u;let{profile:v}=e,f={address:null==v?void 0:v.ownedBy,limit:30},{data:g,loading:j,error:y,fetchMore:b}=(0,r.ug)({variables:{request:f},skip:!(null==v?void 0:v.id)}),w=null==g?void 0:null===(l=g.following)||void 0===l?void 0:l.items;(0,d.qr)(e=>e.currentProfile);let[N,C]=(0,i.useState)("following"),S=null==g?void 0:null===(t=g.following)||void 0===t?void 0:t.pageInfo,{observe:k}=(0,h.Y)({onEnter:async()=>{await b({variables:{request:{cursor:null==S?void 0:S.next,...f}}})}});if(j)return(0,n.jsx)(a.Z,{message:"Loading Following"});if((null==w?void 0:w.length)===0)return(0,n.jsx)("div",{className:"p-5",children:"No Following"});let F=null==g?void 0:g.following.items;return console.log("I Follow",F),(0,n.jsx)("div",{className:"overflow-y-auto max-h-[80vh]",id:"scrollableDiv",children:(0,n.jsx)(s.Z,{dataLength:null!==(u=null==w?void 0:w.length)&&void 0!==u?u:0,next:()=>{},hasMore:!0,loader:(null==S?void 0:S.next)&&(0,n.jsx)("span",{ref:k,className:"flex justify-center p-10",children:(0,n.jsx)(p.Z,{})}),endMessage:(0,n.jsx)("p",{style:{textAlign:"center"},children:(0,n.jsx)("b",{children:"Yay! You have seen it all"})}),children:(0,n.jsx)("div",{children:null==F?void 0:F.map(e=>(0,n.jsx)(x(),{href:"/u/".concat(null==e?void 0:e.profile.id),children:(0,n.jsxs)("div",{className:"flex gap-3 hover:bg-primary p-2 cursor-pointer font-semibold rounded items-center",children:[(0,n.jsx)("div",{className:"relative h-[32px] w-[32px]",children:(0,n.jsx)(m(),{src:(0,o.Z)(null==e?void 0:e.profile),alt:"profilepic",className:"rounded-full",layout:"fill"})}),(0,n.jsx)("div",{}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"flex gap-1 items-center text-md font-bold text-primary lowercase",children:null==e?void 0:e.profile.name}),(0,n.jsxs)("p",{prefix:"@",className:"capitalize text-gray-400 text-xs",children:[(0,c.Z)(null==e?void 0:e.profile.handle),""]})]})]})},null==e?void 0:e.profile.id))})})})};l.Z=f},11761:function(e,l,t){"use strict";t.d(l,{Z:function(){return i}});var n=t(85893),o=t(86010);let i=e=>{let{children:l,as:t="div",className:i="",forceRounded:r=!1,onClick:s}=e;return(0,n.jsx)(t,{className:(0,o.Z)(r?"flex rounded-xl":"rounded-none sm:rounded-xl","border  [#d9dff1f6] ",i),onClick:s,children:l})}},59355:function(e,l,t){"use strict";t.d(l,{b:function(){return n}});let n=e=>e.stopPropagation()},18033:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return ek}});var n=t(85893),o=t(37887),i=t(67294),r=t(15209),s=t(54524),a=t(76781),d=t(21273),c=t(39321),u=t(9507),x=t(11163),v=t(25675),m=t.n(v),p=t(41664),h=t.n(p),f=t(86501),g=t(37331),j=t(9187),y=t(77768),b=t(65475),w=t(56371),N=t(94374),C=t(48764).Buffer;let S="2Km7bBvxqZOmfzYksdcepn58KBe",k="8e8884f5ce9793101a44e58518f8e395";if(!S||!k)throw Error("Must define INFURA_PROJECT_ID and INFURA_SECRET in the .env to run this");let F=(0,N.Ue)({host:"ipfs.infura.io",port:5001,protocol:"https",headers:{authorization:"Basic ".concat(C.from("".concat(S,":").concat(k),"utf-8").toString("base64"))}}),P=async e=>{let l=await F.add(JSON.stringify(e));return console.log("upload result ipfs",l),l};var Z=t(57632),E=t(13250),I=t(83666),T=t.n(I);let R=new(T()).LitNodeClient({alertWhenUnauthorized:!0}),q="mainnet",A=[{contractAddress:"",standardContractType:"",chain:q,method:"",parameters:[":userAddress"],returnValueTest:{comparator:"=",value:"0x1"}},{operator:"or"},{contractAddress:"",standardContractType:"",chain:"mainnet",method:"",parameters:[":userAddress"],returnValueTest:{comparator:"=",value:"0x2"}}],B=(e,l)=>(console.log("Set access control conditions, address 1:",e),A[0].returnValueTest.value=e,A[2].returnValueTest.value=l,console.log("Access control conditions:",A),A);var _=new class{async connect(){try{await R.connect(),this.litNodeClient=R}catch(e){console.log("Error while connecting to Lit nodes",e)}}async encryptString(e,l,t){console.log("Encrypt string address 1:",l),this.litNodeClient||await this.connect();let n=await T().checkAndSignAuthMessage({chain:q}),{encryptedString:o,symmetricKey:i}=await T().encryptString(e);console.log("encrypted string:",o);let r=await B(l,t),s=await this.litNodeClient.saveEncryptionKey({accessControlConditions:r,symmetricKey:i,authSig:n,chain:q});return console.log("access control conditions",B(l,t)),{encryptedFile:o,encryptedSymmetricKey:T().uint8arrayToString(s,"base16")}}async decryptString(e,l,t,n){this.litNodeClient||await this.connect();let o=await T().checkAndSignAuthMessage({chain:q}),i=await this.litNodeClient.getEncryptionKey({accessControlConditions:B(t,n),toDecrypt:l,chain:q,authSig:o}),r=await T().decryptString(e,i);return console.log({decryptedFile:r}),{decryptedFile:r}}};let D=e=>{var l;let{publication:t,refetchComments:o}=e,[u,x]=(0,i.useState)(""),[v,m]=(0,i.useState)(!1),[p,h]=(0,i.useState)(!1),N=(0,r.qr)(e=>e.userSigNonce),C=(0,r.qr)(e=>e.setUserSigNonce),S=(0,r.qr)(e=>e.currentProfile),k=(0,r.nN)(e=>e.txnQueue),F=(0,r.nN)(e=>e.setTxnQueue),{signTypedDataAsync:I}=(0,s.yw)({onError:j.Z});async function R(e){try{var l;let{encryptedFile:n,encryptedSymmetricKey:o}=await _.encryptString(e,null==t?void 0:null===(l=t.profile)||void 0===l?void 0:l.ownedBy,null==S?void 0:S.ownedBy),i=await T().blobToBase64String(n);return{encryptedComment:i,encryptedSymmetricKey:o}}catch(r){console.log("Error during encryption",r)}}let q=()=>{f.ZP.success("Post has been commented!"),x("")};console.log("PUBLICATION ADDRESS",null==t?void 0:null===(l=t.profile)||void 0===l?void 0:l.ownedBy),console.log("CURRENT PROFILE ADDRESS",null==S?void 0:S.ownedBy);let A=e=>{let{txHash:l,txId:n}=e;return{id:(0,Z.Z)(),parent:t.id,type:"NEW_COMMENT",content:u,txHash:l,txId:n}},{error:B,write:D}=(0,s.GG)({address:c.Nm,abi:g.g,functionName:"commentWithSig",mode:"recklesslyUnprepared",onSuccess:e=>{let{hash:l}=e;q(),F([A({txHash:l}),...k])},onError:j.Z}),{broadcast:L}=(0,E.Z)({onCompleted:e=>{var l;q(),F([A({txId:null==e?void 0:null===(l=e.broadcast)||void 0===l?void 0:l.txId}),...k])}}),[M]=(0,d.k9)({onCompleted:async e=>{let{createCommentTypedData:l}=e;try{let{id:t,typedData:n}=l,{profileId:o,contentURI:i,profileIdPointed:r,pubIdPointed:s,collectModule:a,collectModuleInitData:d,referenceModule:u,referenceModuleData:x,referenceModuleInitData:v,deadline:m}=n.value,p=await I((0,b.Z)(n)),{v:h,r:f,s:g}=(0,w.splitSignature)(p),j={profileId:o,contentURI:i,profileIdPointed:r,pubIdPointed:s,collectModule:a,collectModuleInitData:d,referenceModule:u,referenceModuleData:x,referenceModuleInitData:v,sig:{v:h,r:f,s:g,deadline:m}};if(C(N+1),!c.fx)return null==D?void 0:D({recklesslySetUnpreparedArgs:[j]});let{data:{broadcast:y}}=await L({request:{id:t,signature:p}});"reason"in y&&(null==D||D({recklesslySetUnpreparedArgs:[j]}))}catch(S){}},onError:j.Z}),[U]=(0,d.PI)({onCompleted:q,onError:j.Z}),O=async e=>{let{data:l}=await U({variables:{request:e}});(null==l?void 0:l.createCommentViaDispatcher.__typename)==="RelayError"&&M({variables:{options:{overrideSigNonce:N},request:e}})};async function z(){let e="",l="";if(!S)return f.ZP.error("Please connect your Wallet!");if(console.log("Is encryped toggle",p),p){m(!0);let n=await R(u);e=null==n?void 0:n.encryptedComment;let o=null==n?void 0:n.encryptedSymmetricKey,i={litComment:e,litKkey:o};try{console.log("Fetch api route");let r=await fetch("/api/store-encrypted",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(i)});if(200!==r.status)alert("Something went wrong while creating CID");else{let s=await r.json(),d=s.cid;console.log("Encrypted URI",d),l="https://ipfs/".concat(s.cid)}}catch(x){console.log("Error while uploading encrypted comment to ipfs",x)}}try{var v;m(!0);let h=await P({version:"2.0.0",mainContentFocus:a.D2.TextOnly,metadata_id:(0,Z.Z)(),description:"Description",locale:"en-US",content:p?e:u,external_url:null,image:null,imageMimeType:null,name:"Name",attributes:p?[{displayType:"string",traitType:"encrypted",value:l}]:[],tags:[],appId:c.iC}),g={profileId:null==S?void 0:S.id,publicationId:t.id,contentURI:"ipfs://".concat(h.path),collectModule:{revertCollectModule:!0},referenceModule:{followerOnlyReferenceModule:!1}};(null==S?void 0:null===(v=S.dispatcher)||void 0===v?void 0:v.canUseRelay)?await O(g):await M({variables:{options:{overrideSigNonce:N},request:g}})}catch(j){}finally{m(!1)}}return(0,n.jsxs)("div",{className:"flex assolute fixed-bottom p-5 gap-3 border-t",children:[(0,n.jsx)("textarea",{value:u,onChange:e=>x(e.target.value),className:"bg-[#F1F1F2] rounded-xl p-2 flex-grow text-sm outline-none placeholder:text-gray-500 border border-transparent focus:border-gray-300 transition",placeholder:"Add comment.."}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("button",{className:"text-md text-black border-gray-600",onClick:z,disabled:v,children:v?"Commenting...":(0,n.jsx)("div",{className:"cursor-pointer border-1 hover:text-[#57B8FF]",children:"Comment"})}),(0,n.jsx)(y.r.Group,{children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(y.r.Label,{className:"mr-4",children:"Encrypted"}),(0,n.jsx)(y.r,{checked:p,onChange:h,as:i.Fragment,children:e=>{let{checked:l}=e;return(0,n.jsx)("button",{className:"".concat(l?"bg-blue-600":"bg-gray-400"," relative inline-flex h-4 w-8 items-center rounded-full"),children:(0,n.jsx)("span",{className:"".concat(l?"translate-x-5":"translate-x-1"," inline-block h-2 w-2 transform rounded-full bg-white transition")})})}})]})})]})]})};var L=t(72329),M=t(29451);let U=e=>{let{comment:l,publication:t}=e,o=(0,r.qr)(e=>e.currentProfile),[s,a]=(0,i.useState)("");async function d(){let e=l.metadata.attributes[0];if(!e||"encrypted"!==e.traitType)return l.metadata.content;try{let n=l.metadata.attributes[0].value;if(n){let i=await fetch("/api/get-encrypted",{method:"",headers:{"Content-type":"application/json"},body:JSON.stringify({url:n})}),r=await i.json(),s=T().base64StringToBlob(r.litComment),a=await _.decryptString(s,r.litKkey,t.profile.ownedBy,null==o?void 0:o.ownedBy),d=a.decryptedFile;return console.log("DECRYPTED",d),a.decryptedFile?d:"Encrypted Comment"}}catch(c){console.log(c)}}return(0,i.useEffect)(()=>{let e=async()=>{var e;if((null===(e=l.metadata.attributes[0])||void 0===e?void 0:e.traitType)==="encrypted"){let t=await d();console.log("Response decrypted comment:",t),a(t||"Encrypted on LensShare \uD83D\uDC40 : ".concat(l.metadata.content))}else a(l.metadata.content)};e()},[]),(0,n.jsxs)("div",{className:"flex border-2 p-3 bg-cyan-100 rounded-xl hover:bg-blue-400 gap-2",children:[(0,n.jsx)(h(),{href:"/u/".concat(l.profile.id),children:(0,n.jsx)("div",{className:"flex-shrink-0 rounded-full",children:(0,n.jsx)(m(),{width:40,height:40,className:"rounded-full cursor-pointer",src:(0,L.Z)(l.profile),alt:l.profile.handle})})},l.profile.id),(0,n.jsxs)("div",{className:"flex-grow w-[90%]",children:[(0,n.jsx)("p",{className:"font-bold ",children:(0,M.Z)(l.profile.handle)}),(0,n.jsx)("p",{className:"text-sm text-black pt-1 pl-2",style:{wordWrap:"break-word",overflowWrap:"break-word"},children:l.metadata.content})]})]})};var O=t(66252),z=t(9747);let H=e=>{let{txn:l}=e,t=(0,r.qr)(e=>e.currentProfile),o=(0,r.nN)(e=>e.txnQueue),i=(0,r.nN)(e=>e.setTxnQueue),s=null==l?void 0:l.txHash,c=null==l?void 0:l.txId,{cache:u}=(0,O.x)(),v=(0,x.useRouter)(),{id:m}=v.query,p=()=>{s?i(o.filter(e=>e.txHash!==s)):i(o.filter(e=>e.txId!==c))},[h]=(0,d.Xq)({onCompleted:e=>{(null==e?void 0:e.publication)&&(u.modify({fields:{publications(){u.writeQuery({data:null==e?void 0:e.publication,query:a.zS})}}}),p())}});return(0,d.BS)({variables:{request:{txHash:s,txId:c}},pollInterval:1e3,onCompleted:e=>{if("TransactionError"===e.hasTxHashBeenIndexed.__typename)return p;if("TransactionIndexedResult"===e.hasTxHashBeenIndexed.__typename){var l;let n=null===(l=e.hasTxHashBeenIndexed.metadataStatus)||void 0===l?void 0:l.status;if(n===a.gx.MetadataValidationFailed||n===a.gx.NotFound)return p();e.hasTxHashBeenIndexed.indexed&&h({variables:{request:{txHash:e.hasTxHashBeenIndexed.txHash},reactionRequest:t?{profileId:null==t?void 0:t.id}:null}})}}}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)(z.Z,{})})};var K=t(7355);let W=()=>{let e=(0,r.qr)(e=>e.currentProfile);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"cursor-pointer bg-blue-500 text-md text-[#000000] border-grey-400 border-2 font-semibold px-6 py-3 rounded-full outline-none w-full mt-3 hover:text-white hover:bg-blue-500",children:e?(0,n.jsx)("div",{className:"flex justify-center",children:e.handle}):(0,n.jsx)(K.Z,{})})})},Y=e=>{var l,t;let{publication:i}=e,s=(0,r.qr)(e=>e.currentProfile),d=(0,r.nN)(e=>e.txnQueue),c=(0,x.useRouter)(),{id:u}=c.query,v={request:{commentsOf:u}},{data:m,loading:p,error:h,refetch:f}=(0,o.a)(a.zS,{variables:v}),g=null!==(t=null==m?void 0:null===(l=m.publications)||void 0===l?void 0:l.items)&&void 0!==t?t:[];console.log("Comments",g);let j=()=>{f({...v})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"overflow-y-auto",children:(0,n.jsxs)("div",{className:" h-screen text-black flex-grow flex flex-col items-stretch gap-0.3 overflow-y-auto bg-[#F2F4F7] ",children:[d.map(e=>(null==e?void 0:e.type)==="NEW_COMMENT"&&(null==e?void 0:e.parent)===(null==i?void 0:i.id)&&(0,n.jsx)("div",{children:(0,n.jsx)(H,{txn:e})},e.id)),null==g?void 0:g.map(e=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(U,{comment:e,publication:i})}))]})}),s?(0,n.jsx)(D,{publication:i,refetchComments:()=>j()}):(0,n.jsx)(W,{})]})},G=e=>{try{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(e);{let l=document.createElement("textarea");return l.value=e,l.style.position="fixed",l.style.left="-999999px",l.style.top="-999999px",document.body.appendChild(l),l.focus(),l.select(),new Promise((e,t)=>{document.execCommand("copy")?e(void 0):t(),l.remove()})}}catch(t){console.error(t)}};var Q=t(67912),V=t(8193),J=t(7960),X=t(92864),$=t(99767),ee=t(34601),el=t(89169),et=t(93865),en=t(11281),eo=t(30034),ei=t(64208),er=t(33944),es=t(29780),ea=t(16175),ed=t(65561);let ec=e=>{let{publication:l,onSuccess:t}=e,[o,r]=(0,i.useState)("ILLEGAL"),[s,{loading:a}]=(0,ea.jHU)({onError:e=>{var l,t,n;f.ZP.error(null!==(n=null!==(t=null==e?void 0:null===(l=e.data)||void 0===l?void 0:l.message)&&void 0!==t?t:null==e?void 0:e.message)&&void 0!==n?n:c.c9)},onCompleted:()=>{f.ZP.success("Publication reported successfully."),t()}}),d=e=>"ILLEGAL"===e?"illegalReason":"FRAUD"===e?"fraudReason":"SENSITIVE"===e?"sensitiveReason":"SPAM"===e?"spamReason":"illegalReason",u=()=>{let e=o.split("-")[0],t=o.split("-")[1];s({variables:{request:{publicationId:l.id,reason:{[d(e)]:{reason:e,subreason:t}},additionalComments:"".concat(e," - ").concat(t)}}})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(en.Z,{title:"Report Publication • ".concat(c.iC)}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("div",{className:"opacity-60 p-2",children:[(0,n.jsx)("h1",{children:l.metadata.name}),(0,n.jsxs)("span",{className:"text-sm pl-2",children:["by ",l.profile.handle]})]}),(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("label",{className:"block text-xs font-semibold uppercase opacity-70",htmlFor:"report",children:"Reason"}),(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsxs)("select",{onChange:e=>(function(e){throw Error("Function not implemented.")})(e.target.value),className:"outline-none border-2 border-gray-200 text-md capitalize lg:p-4 p-2 rounded cursor-pointer",children:[ed.F5.map(e=>(0,n.jsx)("option",{className:"outline-none capitalize bg-white text-gray-700 text-md p-2 hover:bg-slate-300",value:e.name,children:e.name},e.name)),";"]})}),(0,n.jsx)("div",{className:"mb-1 mt-4 flex justify-end",children:(0,n.jsx)(es.z,{loading:a,onClick:()=>u(),children:"Report"})})]})]})})]})};var eu=t(11761);let ex=e=>{let{show:l,setShowReport:t,video:o}=e;return(0,n.jsx)(ei.u,{title:"Report Publication",onClose:()=>t(!0),show:l,children:(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)(eu.Z,{children:(0,n.jsx)("div",{className:"mt-2 block ",children:(0,n.jsx)(ec,{publication:o,onSuccess:()=>t(!1)})})})})})};var ev=t(11355);let em=e=>{let{children:l,show:t}=e;return(0,n.jsx)(ev.u,{as:i.Fragment,show:t,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:l})};var ep=t(8340),eh=t(86010),ef=t(59355),eg=t(73445);let ej=(0,eg.Ue)(e=>({showPublicationDeleteAlert:!1,deletingPublication:null,forceDeletePublication:!1,setShowPublicationDeleteAlert:(l,t)=>e(()=>({showPublicationDeleteAlert:l,deletingPublication:t})),showModActionAlert:!1,modingPublication:null,setShowModActionAlert:(l,t)=>e(()=>({showModActionAlert:l,modingPublication:t}))}));var ey=t(76249);let eb=e=>{let{publication:l}=e,t=ej(e=>e.setShowPublicationDeleteAlert);return(0,n.jsx)(ep.v.Item,{as:"div",className:e=>{let{active:l}=e;return(0,eh.Z)({"dropdown-active":l},"m-2 block cursor-pointer rounded-lg px-4 py-1.5 text-sm text-red-500")},onClick:e=>{(0,ef.b)(e),t(!0,l)},children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(ey.Z,{className:"h-4 w-4"}),(0,n.jsx)("div",{children:"Delete"})]})})};var ew=t(47516);let eN=e=>{var l;let{publication:t}=e,o=(0,r.qr)(e=>e.currentProfile);return(0,n.jsxs)(ep.v,{as:"div",className:"relative right-2",children:[(0,n.jsx)(ep.v.Button,{as:i.Fragment,children:(0,n.jsx)("button",{className:"rounded-full p-1.5 hover:bg-gray-300/20",onClick:ef.b,"aria-label":"More",children:(0,n.jsx)(ew.JJP,{className:(0,eh.Z)("lt-text-gray-500 right-2","w-[15px] sm:w-[18px]")})})}),(0,n.jsx)(em,{children:(0,n.jsx)(ep.v.Item,{children:(0,n.jsx)("div",{className:"absolute right-0 z-[5] mt-1 w-max rounded-xl border bg-white shadow-sm focus:outline-none",children:(null==o||o.id,null==t||null===(l=t.profile)||void 0===l||l.id,(0,n.jsx)(eb,{publication:t}))})})})]})},eC=e=>{var l,t;let{publication:o,profile:s,setFollowing:a,following:d}=e,u=(0,r.qr)(e=>e.currentProfile),[v,p]=(0,i.useState)(!1),[g,j]=(0,i.useState)(null==o?void 0:null===(l=o.stats)||void 0===l?void 0:l.totalUpvotes),[y,b]=(0,i.useState)(!1),[w,N]=(0,i.useState)(!1),[C,S]=(0,i.useState)(!1),[k,F]=(0,i.useState)(!1),[P,Z]=(0,i.useState)(!1),E=(0,i.useRef)(null),I=(0,x.useRouter)(),{id:T}=I.query,R="https://lenshareapp.xyz/post/".concat(null==o?void 0:o.id),q="".concat((0,M.Z)(null==s?void 0:s.handle)," on LensShare");null==s||s.id,null==u||u.id;let A=()=>{var e,l;y?(null==E||null===(e=E.current)||void 0===e||e.pause(),b(!1)):(null==E||null===(l=E.current)||void 0===l||l.play(),b(!0))};return(0,i.useEffect)(()=>{(null==E?void 0:E.current)&&(E.current.muted=w)},[w]),(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row lg:h-screen items-stretch",children:[(0,n.jsx)(en.Z,{title:"Post • ".concat(c.iC)}),(0,n.jsx)(f.x7,{position:"bottom-right"}),(0,n.jsxs)("div",{className:"lg:flex-grow flex justify-center items-center relative bg-black",children:[(0,n.jsx)("video",{className:"w-auto h-auto object-cover max-w-full max-h-[450px] ",ref:E,onClick:A,muted:!0,loop:!0,src:(0,Q.Z)(o),controls:!0,playsInline:!0,autoPlay:!0}),(0,n.jsx)("div",{className:"absolute top-5 left-5 flex gap-3",children:(0,n.jsx)("button",{onClick:()=>I.back(),className:"w-[40px] h-[40px] rounded-md flex justify-center items-center",children:(0,n.jsx)(ee.Z,{className:"w-5 h-5 fill-white font-semibold cursor-pointer"})})})]}),(0,n.jsxs)("div",{className:"w-full lg:w-[500px] flex-shrink-0 flex flex-col items-stretch h-screen",children:[(0,n.jsxs)("div",{className:"px-4 pt-10 pb-4 flex-shrink-0 border-b",children:[(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)(h(),{legacyBehavior:!0,href:"/u/".concat(null==s?void 0:s.id),children:(0,n.jsx)("a",{className:"mr-3 flex-shrink-0 rounded-full",children:(0,n.jsx)(m(),{src:(0,L.Z)(s),alt:"profile pic here",height:62,width:62,className:"rounded-full"})})},null==s?void 0:s.id),(0,n.jsxs)("div",{className:"flex p-1 flex-col flex-grow justify-center",children:[(0,n.jsx)(h(),{href:"/u/".concat(null==s?void 0:s.id),children:(0,n.jsx)("a",{className:"font-bold block hover:underline items-center text-primary",children:null==s?void 0:s.name})},null==s?void 0:s.id),(0,n.jsx)("p",{prefix:"@",className:"capitalize font-medium text-sm text-gray-500",children:(0,M.Z)(null==s?void 0:s.handle)})]}),(0,n.jsx)("div",{className:"flex-shrink-0",children:d?(0,n.jsx)(J.Z,{setFollowing:a,profile:s}):(0,n.jsx)(X.Z,{setFollowing:a,profile:s})})]}),(0,n.jsx)("div",{className:"right-2",children:(0,n.jsx)(eN,{publication:o})}),(0,n.jsx)("div",{children:(0,n.jsxs)("button",{className:"flex left-3 items-center text-sm margin-1 rounded-3xl gap-2 cursor-pointer",onClick:()=>{Z(!P)},children:[(0,n.jsx)("span",{children:"Report"}),(0,n.jsx)(ex,{show:P,setShowReport:Z,video:o})]})}),(0,n.jsxs)("div",{className:"flex gap-4 mt-3 cursor-pointer",onClick:()=>{F(!k)},children:[(0,n.jsxs)("div",{className:"flex items-center text-sm margin-1 rounded-3xl gap-2",children:[(0,n.jsxs)("span",{className:"font-bold text-sx",children:[" ",null==s?void 0:s.stats.totalFollowing," "]}),(0,n.jsx)("span",{children:"Following"}),(0,n.jsx)(ei.u,{title:"Following",show:k,onClose:()=>F(!1),children:(0,n.jsx)(eo.Z,{profile:s})})]}),(0,n.jsxs)("div",{className:"flex items-center text-sm margin-1 rounded-3xl gap-2 cursor-pointer",onClick:()=>{S(!C)},children:[(0,n.jsx)("span",{className:"font-bold text-sx",children:null==s?void 0:s.stats.totalFollowers}),(0,n.jsx)("span",{children:"Followers"}),(0,n.jsx)(ei.u,{title:"Followers",show:C,onClose:()=>S(!1),children:(0,n.jsx)(er.Z,{profile:null==s?void 0:s.id})})]})]}),(0,n.jsx)("p",{className:"my-3 pb-3 text-sm text-gray-600",style:{wordWrap:"break-word",overflowWrap:"break-word"},children:null===(t=null==o?void 0:o.metadata.description)||void 0===t?void 0:t.slice(0,500)}),(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"flex gap-5",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("button",{className:"w-9 h-9 p-2 bg-[#F1F1F2] fill-black flex justify-center items-center rounded-full",children:(0,n.jsx)($.Z,{publication:o,setCount:j,setLiked:p,count:g,liked:v})}),(0,n.jsx)("span",{className:"text-center text-xs font-semibold",children:null==o?void 0:o.stats.totalUpvotes})]}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("button",{className:"fill-black w-9 h-9 flex md:pb-3 lg:pb-3 justify-center items-center ",children:(0,n.jsx)(et.Z,{publication:o})}),(0,n.jsx)("p",{className:"text-center text-xs font-semibold",children:null==o?void 0:o.stats.totalAmountOfCollects})]}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("button",{className:"w-9 h-9 bg-[#F1F1F2] fill-black flex justify-center items-center text-center rounded-full",children:(0,n.jsx)(el.Z,{className:"w-4 h-4 text-[#57B8FF] font-bold md:text-white"})}),(0,n.jsx)("p",{className:"text-center text-xs font-semibold",children:null==o?void 0:o.stats.totalAmountOfComments})]})]}),(0,n.jsx)("div",{className:"flex gap-1 rounded-xl items-center",children:(0,n.jsx)("a",{href:"http://twitter.com/share?text=".concat(encodeURIComponent(q),"&url=").concat(encodeURIComponent(R)),target:"_blank",rel:"noopener noreferrer",className:"rounded-xl",children:(0,n.jsx)(V.wod,{className:"fill-[#05AAF4] w-8 h-8"})})})]}),(0,n.jsxs)("div",{className:"flex items-stretch mt-3",children:[(0,n.jsx)("input",{onClick:e=>{var l,t;return null===(l=e.target)||void 0===l?void 0:null===(t=l.select)||void 0===t?void 0:t.call(l)},className:"bg-[#F1F1F2] p-2 flex-grow text-sm border outline-none",readOnly:!0,type:"text",value:R}),(0,n.jsx)("button",{className:"flex-shrink-0 border px-2 active:bg-blue-500 cursor-pointer",onClick:()=>{G(R)},children:"Copy link"})]})]}),(0,n.jsx)(Y,{publication:o},null==o?void 0:o.profile.id)]})]})},eS=()=>{var e;let[l,t]=(0,i.useState)(!1),v=(0,r.qr)(e=>e.currentProfile),m=(0,x.useRouter)(),{id:p}=m.query,[h,f]=(0,i.useState)(!1);(0,i.useEffect)(()=>{t(!0)},[]),console.log(l);let g=(0,r.qr)(e=>e.setProfiles),j=(0,r.qr)(e=>e.setUserSigNonce),y=(0,r.qr)(e=>e.setCurrentProfile),b=(0,r.Fc)(e=>e.profileId),w=(0,r.Fc)(e=>e.setProfileId),N=(0,r.HB)(e=>e.setSelectedReferenceModule),{address:C,isDisconnected:S}=(0,s.mA)(),{chain:k}=(0,s.LN)(),{disconnect:F}=(0,s.qL)(),P=()=>{w(null),y(null)},Z=()=>{let e=localStorage.getItem("accessToken"),l=localStorage.getItem("refreshToken");return"undefined"!==e&&"undefined"!==l},E=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")},{loading:I}=function(e){let l={...e};return o.a(a.Yg,l)}({variables:{ownedBy:C},skip:!b,onCompleted:e=>{var l,t,n,o,i,r;let s=null===(l=null===(t=null==e?void 0:null===(n=e.profiles)||void 0===n?void 0:null===(o=n.items)||void 0===o?void 0:o.slice())||void 0===t?void 0:t.sort((e,l)=>Number(e.id)-Number(l.id)))||void 0===l?void 0:l.sort((e,l)=>e.isDefault===l.isDefault?0:e.isDefault?-1:1);if(!s.length)return P();let d=s.find(e=>e.id===b),c=(null==d?void 0:null===(i=d.stats)||void 0===i?void 0:i.totalFollowing)||0;N(c>20?a._9.DegreesOfSeparationReferenceModule:a._9.FollowerOnlyReferenceModule),g(s),y(d),w(null==d?void 0:d.id),j(null==e?void 0:null===(r=e.userSigNonces)||void 0===r?void 0:r.lensHubOnChainSigNonce)}}),T=()=>{let e=null==v?void 0:v.ownedBy,l=(null==k?void 0:k.id)!==c.Kj,t=!Z()||l||S||void 0!==e&&e!==C;t&&b&&(P(),E(),null==F||F())},{data:R,error:q}=(0,d.Kw)({variables:{request:{publicationId:p}}}),A=null==R?void 0:null===(e=R.publication)||void 0===e?void 0:e.profile;console.log("Profile",A);let B=null==R?void 0:R.publication;return(console.log("Publication",B),(0,i.useEffect)(()=>{T()},[S,C,k,F,b]),I||!l)?(0,n.jsx)(u.Z,{}):(0,n.jsx)("div",{children:(0,n.jsx)(eC,{publication:B,profile:A,setFollowing:f,following:h})})};var ek=eS},35883:function(){},36563:function(){},63897:function(){},88924:function(){}},function(e){e.O(0,[3714,8766,7025,2692,4980,2013,5445,9866,3874,4617,5592,7856,6552,8179,3987,1664,9869,713,6064,5006,7806,5116,1186,7410,9717,5056,9774,2888,179],function(){return e(e.s=23208)}),_N_E=e.O()}]);