(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7253],{98320:function(e,s,t){"use strict";t.d(s,{Z:function(){return ee}});var n=t(85893),r=t(22257),a=t(81137),l=t(29451);let i=e=>{let s=e.toLowerCase();return"https://cdn.stamp.fyi/avatar/eth:".concat(s,"?s=300")};var o=t(31586),d=t(1257),c=t(86010),u=t(11163),m=t(92882),v=t(88559),f=t(30052),g=t(48900);let x=e=>{let{message:s}=e;if(s.contentType.sameAs(d.Ip))return(0,n.jsx)("span",{children:s.content});if(!s.contentType.sameAs(v.ContentTypeRemoteAttachment))return(0,n.jsx)("span",{children:"''"});{let t=s.content;return(0,n.jsx)("span",{children:t.filename})}},h=e=>{var s,t;let{ensName:d,profile:v,message:h,conversationKey:p,isSelected:w}=e,y=(0,u.useRouter)(),b=(0,m.qr)(e=>e.currentProfile),j=null==b?void 0:b.ownedBy,N=e=>{y.push(e?"/messages/".concat(p):"/messages")},M=null!==(s=d&&i(null==p?void 0:p.split("/")[0]))&&void 0!==s?s:"";return(null==h?void 0:h.content)&&(0,n.jsx)("div",{className:(0,c.Z)("cursor-pointer py-3 hover:bg-gray-100 dark:hover:bg-blue-100",w&&"bg-gray-50 dark:bg-gray-800"),onClick:()=>N((null==v?void 0:v.id)?v.id:p),"aria-hidden":"true",children:(0,n.jsxs)("div",{className:"flex space-x-3 overflow-hidden px-5",children:[(0,n.jsx)(f.E,{src:d?M:(0,r.Z)(v),loading:"lazy",className:"h-10 w-10 rounded-full border bg-gray-200 dark:border-gray-700",height:40,width:40,alt:(0,l.Z)(null==v?void 0:v.handle)}),(0,n.jsxs)("div",{className:"grow overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex justify-between space-x-1",children:[(0,n.jsx)("div",{className:"flex items-center gap-1 overflow-hidden",children:(0,n.jsx)("div",{className:"text-md truncate",children:(null==v?void 0:v.name)?null!==(t=(0,o.Z)(null==v?void 0:v.name))&&void 0!==t?t:(0,l.Z)(v.handle):null!=d?d:(0,a.Z)(null==p?void 0:p.split("/")[0])})}),(null==h?void 0:h.sent)&&(0,n.jsx)("span",{className:"lt-text-gray-500 shrink-0 pt-0.5 text-xs",title:(0,g.Z)(h.sent),children:(0,g.Z)(h.sent)})]}),(0,n.jsxs)("span",{className:"lt-text-gray-500 line-clamp-1 break-all text-sm",children:[j===(null==h?void 0:h.senderAddress)&&"You: ",(0,n.jsx)(x,{message:h})]})]})]})})},p=(e,s)=>{let t=[];for(let n=0;n<e.length;n+=s){let r=e.slice(n,n+s);t.push(r)}return t};var w=t(43799),y=t(67294),b=t(10116),j=t(66949);let N=async(e,s)=>{let t=await e.messages({limit:1,direction:d.Sr.SORT_DIRECTION_DESCENDING,startTime:s?new Date(s.getTime()+1):void 0});return t.length<=0?null:t[0]},M=()=>{let e=(0,b.G)(e=>e.conversations),s=(0,b.G)(e=>e.previewMessages),t=(0,b.G)(e=>e.client),n=(0,m.qr)(e=>e.currentProfile),{batchPersistPreviewMessages:r}=(0,j.F)(),a=(0,b.G)(e=>e.hasSyncedMessages),l=(0,b.G)(e=>e.setHasSyncedMessages),[i,o]=(0,y.useState)(!1),d=(0,y.useRef)(!1),c=(0,y.useRef)(0),[u,v]=(0,y.useState)(0);return(0,y.useEffect)(()=>{if(!t||d.current||a)return;let n=async()=>{let t=[...e.values()];if(t.length){for(let n of(d.current=!0,o(!0),p(t,50))){await new Promise(e=>requestAnimationFrame(e));let a=(await Promise.all(n.map(async e=>{var n,r,a;let l=(0,w.I)(e.peerAddress,null!==(a=null===(n=e.context)||void 0===n?void 0:n.conversationId)&&void 0!==a?a:""),i=null===(r=s.get(l))||void 0===r?void 0:r.sent,o=await N(e,i);if(c.current=c.current+1,v(Math.round(c.current/t.length*100)),o&&(!i||o.sent>i))return[l,o]}))).filter(e=>Boolean(e));await r(new Map(a))}o(!1),l(!0),d.current=!1}};n()},[t,e,null==n?void 0:n.id]),(0,y.useEffect)(()=>{l(!1)},null==n?void 0:n.id),{loading:i,progress:u}};var S=t(14382),C=t(68980),k=t(91648),I=t(5649),P=t(6154);let Z=async e=>{let s=await (0,P.Z)(I.Sj,{method:"POST",data:JSON.stringify({addresses:e.map(e=>e.split("/")[0])})});return s.data};var A=t(67946);let E=e=>{let{client:s}=(0,S.Z)(!0),t=(0,y.useRef)(),n=(0,y.useRef)(async e=>{t.current&&(t.current=void 0),void 0!==e&&(await e).return()});(0,y.useEffect)(()=>{let r=t.current,a=n.current,l=async()=>{if(void 0!==s&&!t.current)try{for await(let n of(t.current=s.conversations.stream(),await (r=t.current)))e(n)}catch(l){throw a(r),l}};return l(),()=>{a(r)}},[e,s])},T=e=>{let{client:s}=(0,S.Z)(!0),t=(0,y.useRef)(),n=(0,y.useRef)(async e=>{t.current&&(t.current=void 0),void 0!==e&&(await e).return(void 0)});(0,y.useEffect)(()=>{let r=t.current,a=n.current,l=async()=>{if(void 0!==s&&!t.current)try{for await(let n of(t.current=s.conversations.streamAllMessages(),await (r=t.current)))e(n)}catch(l){throw a(r),l}};return l(),()=>{a(r)}},[e,s])},q=()=>{let e=(0,u.useRouter)(),s=(0,m.qr)(e=>e.currentProfile),t=(0,b.G)(e=>e.conversations),n=(0,b.G)(e=>e.setConversations),r=(0,b.G)(e=>e.previewMessages),a=(0,b.G)(e=>e.selectedProfileId),l=(0,b.G)(e=>e.setPreviewMessages),i=(0,b.G)(e=>e.setSelectedProfileId),o=(0,b.G)(e=>e.reset),c=(0,b.G)(e=>e.syncedProfiles),v=(0,b.G)(e=>e.addSyncedProfiles),{client:f,loading:g}=(0,S.Z)(),[x,h]=(0,y.useState)(new Set),[N,M]=(0,y.useState)(new Set),[I,P]=(0,y.useState)(!0),[q,R]=(0,y.useState)(!1),[L,G]=(0,y.useState)(),[F]=(0,C.jgS)(),B=(0,b.G)(e=>e.selectedTab),O=(0,b.G)(e=>e.setEnsNames),z=(0,b.G)(e=>e.ensNames),[D,U]=(0,y.useState)(new Map),[K,W]=(0,y.useState)(0),{persistPreviewMessage:J,previewMessages:_,messageProfiles:Q,batchPersistProfiles:$}=(0,j.F)(),V=(0,y.useCallback)(e=>{var t;let n=(0,w.M)(e),r=null==s?void 0:s.id;return n&&r&&null!==(t=n.members.find(e=>e!==r))&&void 0!==t?t:null},[null==s?void 0:s.id]);(0,y.useEffect)(()=>{let e=async()=>{if(!f||!_)return;let e=new Map(r);for(let s of _){let t=e.get(s.conversationKey);if(!t||s.sent>t.sent){let n=await d.lY.fromBytes(s.messageBytes,f),{conversationKey:a}=s;e.set(a,n)}}l(e)};e()},[f,_]),(0,y.useEffect)(()=>{let e=async()=>{if(("Other"===B||"All"===B)&&z.size<N.size){let e=p(Array.from(N),50),s=new Map;for(let t of e){let n=await Z(t),r=n.data,a=0;for(let l of r)""!==l&&s.set(t[a],l),a++}O(new Map(s))}};e()},[B]),(0,y.useEffect)(()=>{if(q)return;let e=new Set(x);for(let t of c)e.delete(t);if(!e.size)return;let n=async()=>{R(!0);let t=p(Array.from(e),50);try{for(let n of t){var r;let a=new Map,l=await F({variables:{request:{profileIds:n}}});if(!(null===(r=l.data)||void 0===r?void 0:r.profiles.items.length))continue;let i=l.data.profiles.items;for(let o of i){let d=o.ownedBy,c=(0,w.I)(d,(0,k.Z)(null==s?void 0:s.id,o.id));a.set(c,o)}$(a),v(n)}}catch(u){G(u)}R(!1)};n()},[x,c]),(0,y.useEffect)(()=>{if(!f||!s)return;let e=async()=>{P(!0);let e=new Map(t),s=new Set(x),r=new Set(N),a=await f.conversations.list();for(let l of a){var i,o;let d=(0,w.I)(l.peerAddress,null!==(o=null===(i=l.context)||void 0===i?void 0:i.conversationId)&&void 0!==o?o:""),c=V(d);c?s.add(c):r.add(d),e.set(d,l)}n(e),s.size>x.size&&h(s),r.size>N.size&&M(r),P(!1)};e()},[f,null==s?void 0:s.id,a]);let Y=(0,y.useCallback)(e=>{var s;let t=null===(s=e.conversation.context)||void 0===s?void 0:s.conversationId,n=(0,w.I)(e.conversation.peerAddress,null!=t?t:"");J(n,e)},[J]);T(Y);let H=(0,y.useCallback)(e=>{var s,r;let a=new Map(t),l=new Set(x),i=new Set(N),o=(0,w.I)(e.peerAddress,null!==(r=null==e?void 0:null===(s=e.context)||void 0===s?void 0:s.conversationId)&&void 0!==r?r:"");a.set(o,e);let d=V(o);d&&!x.has(d)?(l.add(d),h(l)):(i.add(o),M(i)),n(a)},[t,V,N,x,n]);return E(H),(0,y.useEffect)(()=>{a&&(null==s?void 0:s.id)!==a?(o(),i(null==s?void 0:s.id),e.push("/messages")):i(null==s?void 0:s.id)},[s]),(0,y.useEffect)(()=>{let e=Array.from(Q||[]).reduce((e,s)=>{let[t,n]=s;return r.has(t)&&(n.isFollowedByMe?e[0].set(t,n):e[1].set(t,n)),e},[new Map,new Map]),s=new Map;Array.from(N).map(e=>{s.set(e,{})}),B===A.T0.Lens?U(e[0]):B===A.T0.Requests?U(e[1]):B===A.T0.Other?U(s):U(new Map([...e[0],...s])),W(e[1].size)},[Q,B]),{authenticating:g,loading:I||q&&!(null==Q?void 0:Q.size),messages:r,profilesToShow:D,requestedCount:K,profilesError:L}};var R=t(26246),L=t(21094),G=t(11761),F=t(61452),B=t(4108);let O=e=>{let{name:s,icon:t,active:r,count:a,className:l,showOnSm:i=!1,onClick:o}=e;return(0,n.jsxs)("button",{type:"button",onClick:o,className:(0,c.Z)({"text-brand bg-brand-100 bg-opacity-100 dark:bg-opacity-20":r},"hover:bg-brand-100 flex items-center space-x-2 rounded-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-opacity-100 dark:hover:bg-opacity-20 sm:px-3 sm:py-1.5"),"aria-label":s,children:[t,(0,n.jsx)("span",{className:(0,c.Z)({"hidden sm:block":!i}),children:s}),a?(0,n.jsx)("span",{className:(0,c.Z)({"bg-brand-200 dark:bg-brand-800":r},"rounded-full bg-gray-200 px-2 text-xs dark:bg-gray-800"),children:(0,B.Z)(a)}):null]})};var z=t(9747),D=t(64208),U=t(47516),K=t(61286),W=t(33962),J=t(53854),_=t(31415),Q=t(86913),$=t(47422);let V=e=>{let{hideDropdown:s=!1,onProfileSelected:t,placeholder:r="Search…",modalWidthClassName:a="max-w-md"}=e,{push:i,pathname:o,query:d}=(0,u.useRouter)(),[m,v]=(0,y.useState)(""),f=(0,y.useRef)(null);(0,Q.Z)(f,()=>v(""));let[g,{data:x,loading:h}]=(0,C.mpp)(),p=e=>{let t=e.target.value;v(t),"/search"===o||s||g({variables:{request:{type:C.qkC.Profile,query:t,customFilters:[C.U9Q.Gardeners],limit:8}}})},w=e=>{e.preventDefault(),"/search"===o?i("/search?q=".concat(encodeURIComponent(m),"&type=").concat(d.type)):i("/search?q=".concat(encodeURIComponent(m),"&type=profiles")),v("")},b=null==x?void 0:x.search,j=b&&b.hasOwnProperty("items"),N=j?b.items:[];return(0,n.jsxs)("div",{"aria-hidden":"true",className:"w-full pb-4","data-testid":"global-search",children:[(0,n.jsx)("form",{onSubmit:w,children:(0,n.jsx)(K.I,{type:"text",className:"px-3 py-2 text-sm",placeholder:r,value:m,iconLeft:(0,n.jsx)(J.MM7,{}),iconRight:(0,n.jsx)(_.Z,{className:(0,c.Z)("cursor-pointer",m?"visible":"invisible"),onClick:()=>v("")}),onChange:p})}),"/search"!==o&&!s&&m.length>0&&(0,n.jsx)("div",{className:(0,c.Z)("justify-content absolute mt-2 flex w-[90%] flex-col  items-center rounded-xl text-xs",a),ref:f,"data-testid":"search-profiles-dropdown",children:(0,n.jsx)(G.Z,{className:"justify-content max-h-[80vh] items-center overflow-y-auto rounded-xl bg-white dark:bg-gray-900/70 py-2 text-xs",children:h?(0,n.jsxs)("div",{className:"space-y-2 px-4 py-2 text-center text-sm font-bold",children:[(0,n.jsx)(W.$,{size:"sm",className:"mx-auto"}),(0,n.jsx)("div",{children:"Searching users"})]}):(0,n.jsxs)(n.Fragment,{children:[N.map(e=>(0,n.jsx)("div",{className:"cursor-pointer bg-white dark:bg-gray-900/70 px-4 py-2 ",onClick:()=>{t&&t(e),v("")},"data-testid":"search-profile-".concat((0,l.Z)(null==e?void 0:e.handle)),children:(0,n.jsx)($.Z,{query:"".concat((0,l.Z)(null==e?void 0:e.handle))})},null==e?void 0:e.handle)),0===N.length&&(0,n.jsx)("div",{className:"px-4 py-2",children:"No matching users"})]})})})]})};var Y=t(41741);let H=e=>{let{title:s,error:t,className:r=""}=e;return t?(0,n.jsxs)("div",{className:"space-y-1 rounded-xl border-2 border-red-500/50 bg-red-50 p-4 dark:bg-red-900/10 ".concat(r),children:[s&&(0,n.jsx)("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:s}),(0,n.jsx)("div",{className:"text-sm text-red-700 dark:text-red-200",children:null==t?void 0:t.message})]}):null},X=e=>{let{className:s,selectedConversationKey:t}=e,r=(0,u.useRouter)(),a=(0,m.qr)(e=>e.currentProfile),{persistProfile:l}=(0,j.F)(),i=(0,b.G)(e=>e.selectedTab),o=(0,b.G)(e=>e.ensNames),d=(0,b.G)(e=>e.setSelectedTab),[v,f]=(0,y.useState)(!1),{authenticating:g,loading:x,messages:p,profilesToShow:N,requestedCount:S,profilesError:C}=q(),{loading:I,progress:P}=M(),Z=(0,b.N)(e=>e.clearMessagesBadge),E=Array.from(N).sort((e,s)=>{var t,n;let[r]=e,[a]=s,l=p.get(r),i=p.get(a);return((null==l?void 0:null===(t=l.sent)||void 0===t?void 0:t.getTime())||0)>=((null==i?void 0:null===(n=i.sent)||void 0===n?void 0:n.getTime())||0)?-1:1});(0,y.useEffect)(()=>{a&&Z(a.id)},[a]);let T=a&&g,B=x&&(0===p.size||0===N.size),K=()=>{f(!0)},W=async e=>{let s=(0,k.Z)(null==a?void 0:a.id,e.id),t=(0,w.I)(e.ownedBy,s);await l(t,e);let n=e.isFollowedByMe?A.T0.Lens:A.T0.Requests;d(n),r.push("/messages/".concat(t)),f(!1)};return(0,n.jsxs)(L.ST,{className:(0,c.Z)("xs:h-[100vh] xs:mx-2 xs:col-span-4 w-full justify-between rounded-xl sm:mx-2 sm:h-[76vh] md:h-[80vh] xl:h-[84vh]",s),children:[(0,n.jsxs)(G.Z,{className:"flex h-full flex-col justify-between rounded-xl",children:[(0,n.jsxs)("div",{className:"divider relative flex items-center justify-between p-5",children:[(0,n.jsx)("div",{className:"font-bold",children:"Messages"}),a&&!T&&!B&&(0,n.jsx)("button",{onClick:K,type:"button",children:(0,n.jsx)(F.Z,{className:"h-6 w-6"})}),I&&(0,n.jsx)("progress",{className:"absolute -bottom-1 left-0 h-1 w-full appearance-none border-none bg-transparent",value:P,max:100})]}),(0,n.jsxs)("div",{className:"flex justify-between px-4 py-3",children:[(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)(O,{className:"p-2 px-4 text-blue-500",name:"All",active:"All"===i,onClick:()=>d("All"),showOnSm:!0,icon:void 0}),(0,n.jsx)(O,{className:"p-2 px-4 text-blue-500",name:"Lens",active:"Lens"===i,onClick:()=>d("Lens"),showOnSm:!0,icon:void 0}),(0,n.jsx)(O,{className:"p-2 px-4 text-blue-500",name:"Other",active:"Other"===i,onClick:()=>d("Other"),showOnSm:!0,icon:void 0})]}),(0,n.jsx)(O,{className:"p-2 px-4 text-blue-500",name:S>99?"99+":"".concat(S.toString()," Requests"),active:i===A.T0.Requests,onClick:()=>d(A.T0.Requests),showOnSm:!0,icon:void 0})]}),i===A.T0.Requests?(0,n.jsx)("div",{className:" p-2 px-5 text-sm text-blue-700",children:"These conversations are from Lens profiles that you dot currently follow."}):null,(0,n.jsx)("div",{className:"mb-10 h-full",children:T?(0,n.jsx)("div",{className:" items-center justify-center",children:(0,n.jsx)(z.Z,{message:"Awaiting signature to enable DMs"})}):B?(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsx)(z.Z,{message:"Loading conversations"})}):C?(0,n.jsx)(H,{className:"m-5",title:"Failed to load messages",error:{message:Y.D.SomethingWentWrong,name:Y.D.SomethingWentWrong}}):0===E.length?(0,n.jsx)("button",{className:" w-full justify-items-center",onClick:K,type:"button"}):(0,n.jsx)(R.OO,{className:"mx-2 mb-[70vh] justify-around",data:E,itemContent:(e,s)=>{let[r,a]=s,l=p.get(r);return(0,n.jsx)(h,{ensName:o.get(r),isSelected:r===t,profile:a,conversationKey:r,message:l},r)}})})]}),(0,n.jsx)(D.u,{title:"New message",icon:(0,n.jsx)(U.W7F,{className:"text-brand h-5 w-5"}),size:"sm",show:v,onClose:()=>f(!1),children:(0,n.jsx)("div",{className:"pb w-full px-4 pt-4",children:(0,n.jsx)(V,{modalWidthClassName:"max-w",placeholder:"Search for someone to message...",onProfileSelected:W})})})]})};var ee=X},47422:function(e,s,t){"use strict";var n=t(85893),r=t(21273),a=t(68980);t(67294);var l=t(33962),i=t(30052),o=t(22257),d=t(41664),c=t.n(d),u=t(29451),m=t(9507),v=t(5276);let f=e=>{var s,t;let{query:d}=e,f={query:d,type:a.qkC.Profile,limit:5},{data:g,loading:x,error:h,fetchMore:p}=(0,r.Fh)({variables:{request:f},skip:!d}),w=null==g?void 0:null===(s=g.search)||void 0===s?void 0:s.items,y=null==g?void 0:null===(t=g.search)||void 0===t?void 0:t.pageInfo;if((null==y?void 0:y.next)&&(null==w||w.length,y.totalCount),console.log(w),(null==w?void 0:w.length)===0)return(0,n.jsxs)("div",{children:["No profiles for ",(0,n.jsxs)("b",{children:["“",d,"”"]})]});if(h)return(0,n.jsx)("div",{children:"Failed to load profiles"});x&&(n.Fragment,l.$);let{observe:b}=(0,v.Y)({onEnter:async()=>{await p({variables:{request:{cursor:null==y?void 0:y.next,...f}}})}});return(0,n.jsxs)("div",{className:"space-y-3 rounded-xl",children:[null==w?void 0:w.map(e=>(0,n.jsx)("div",{className:"p-5",children:(0,n.jsx)(c(),{href:"/u/".concat(null==e?void 0:e.id),children:(0,n.jsxs)("div",{className:"flex cursor-pointer items-center gap-3 rounded-xl p-2 font-semibold",children:[(0,n.jsx)(i.E,{width:62,height:62,className:"cursor-pointer rounded-full",src:(0,o.Z)(e),alt:(0,u.Z)(null==e?void 0:e.handle)}),(0,n.jsx)("div",{className:" lg:block",children:(0,n.jsxs)("p",{className:"text-md flex items-center gap-1 font-bold lowercase text-primary",children:[null==e?void 0:e.name,(0,n.jsxs)("p",{className:"capitalize text-gray-400",children:[(0,u.Z)(null==e?void 0:e.handle),""]})]})})]})})},null==e?void 0:e.id)),(null==y?void 0:y.next)&&(0,n.jsx)("span",{ref:b,className:"flex justify-center border-0 p-10",children:(0,n.jsx)(m.Z,{})})]})};s.Z=f},39059:function(e,s,t){"use strict";t.d(s,{cp:function(){return i},l0:function(){return o},w5:function(){return l}});var n=t(85893),r=t(56312),a=t(87536);let l=e=>{let{schema:s,...t}=e;return(0,a.cI)({...t,resolver:(0,r.F)(s)})},i=e=>{let{name:s}=e,{formState:{errors:t}}=(0,a.Gc)();if(!s)return null;let r=t[s];return r?(0,n.jsx)("div",{className:"mt-1 text-sm font-bold text-red-500",children:r.message}):null},o=e=>{let{form:s,onSubmit:t,children:r,className:l=""}=e;return(0,n.jsx)(a.RV,{...s,children:(0,n.jsx)("form",{onSubmit:s.handleSubmit(t),children:(0,n.jsx)("fieldset",{className:"flex flex-col ".concat(l),disabled:s.formState.isSubmitting,children:r})})})}},21094:function(e,s,t){"use strict";t.d(s,{Me:function(){return r},ST:function(){return a},VK:function(){return l}});var n=t(85893);let r=e=>{let{children:s,className:t="",classNameChild:r=""}=e;return(0,n.jsx)("div",{className:"container mx-auto max-w-screen-xl grow px-0 pb-2 pt-8 sm:px-5 ".concat(t),children:(0,n.jsx)("div",{className:"grid grid-cols-12 lg:gap-8 ".concat(r),children:s})})},a=e=>{let{children:s,className:t=""}=e;return(0,n.jsx)("div",{className:"col-span-12 md:col-span-12 lg:col-span-4 ".concat(t),children:s})},l=e=>{let{children:s,className:t=""}=e;return(0,n.jsx)("div",{className:"col-span-12 mb-5 md:col-span-12 lg:col-span-8 ".concat(t),children:s})}},61286:function(e,s,t){"use strict";t.d(s,{I:function(){return c}});var n=t(85893),r=t(86010),a=t(5152),l=t.n(a),i=t(67294),o=t(39059);let d=l()(()=>Promise.all([t.e(2697),t.e(2252)]).then(t.bind(t,22252)),{loadableGenerated:{webpack:()=>[22252]}}),c=(0,i.forwardRef)(function(e,s){let{label:t,prefix:a,type:l="text",iconLeft:c,iconRight:u,error:m,className:v="",helper:f,...g}=e,x=(0,i.useId)(),h=["text-zinc-500 [&>*]:peer-focus:text-brand [&>*]:h-5",{"!text-red-500 [&>*]:peer-focus:!text-red-500":m}];return(0,n.jsxs)("label",{className:"w-full",htmlFor:x,children:[t&&(0,n.jsxs)("div",{className:"mb-1 flex items-center space-x-1.5",children:[(0,n.jsx)("div",{className:"font-medium text-gray-800 dark:text-gray-200",children:t}),(0,n.jsx)(d,{content:f})]}),(0,n.jsxs)("div",{className:"flex",children:[a&&(0,n.jsx)("span",{className:"lt-text-gray-500 inline-flex items-center rounded-l-xl border border-r-0 border-gray-300 bg-gray-100 px-3 dark:border-gray-700",children:a}),(0,n.jsxs)("div",{className:(0,r.Z)({"bg-gray-500/20 opacity-60":g.disabled},m?"!border-red-500":"focus-within:ring-1",a?"rounded-r-xl":"rounded-xl","focus-within:border-brand-500 focus-within:ring-brand-400 flex w-full items-center border border-gray-300 bg-white dark:bg-gray-900/70 p-3 dark:border-gray-700 dark:bg-gray-100"),children:[(0,n.jsx)("input",{id:x,className:(0,r.Z)({"placeholder:text-red-500":m},a?"rounded-r-xl":"rounded-xl","peer w-full border-none bg-transparent outline-none focus:ring-0",v),type:l,ref:s,...g}),(0,n.jsx)("span",{tabIndex:-1,className:(0,r.Z)({"order-first pl-3":c},h),children:c}),(0,n.jsx)("span",{tabIndex:-1,className:(0,r.Z)({"order-last pr-3":u},h),children:u})]})]}),g.name&&(0,n.jsx)(o.cp,{name:g.name})]})})},64208:function(e,s,t){"use strict";t.d(s,{u:function(){return d}});var n=t(85893),r=t(44080),a=t(92485),l=t(5362),i=t(86010),o=t(67294);let d=e=>{let{icon:s,title:t,size:d="sm",show:c,children:u,dataTestId:m="",onClose:v}=e;return(0,n.jsx)(r.u.Root,{show:c,as:o.Fragment,children:(0,n.jsx)(a.V,{as:"div",className:"fixed inset-0 z-[20] overflow-y-auto",onClose:()=>null==v?void 0:v(),"data-testid":m,children:(0,n.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4 text-center sm:block sm:p-0",children:[(0,n.jsx)(r.u.Child,{as:o.Fragment,enter:"ease-out duration-100",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,n.jsx)(a.V.Overlay,{className:"fixed inset-0 bg-gray-500/75 transition-opacity "})}),(0,n.jsx)("span",{className:" sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"}),(0,n.jsx)(r.u.Child,{as:o.Fragment,enter:"ease-out duration-100",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-100",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,n.jsxs)("div",{className:(0,i.Z)({"sm:max-w-5xl":"lg"===d},{"sm:max-w-3xl":"md"===d},{"sm:max-w-lg":"sm"===d},{"sm:max-w-sm":"xs"===d},"inline-block w-full scale-100 rounded-xl bg-blue-700/80 text-left align-bottom shadow-xl transition-all sm:my-8 sm:align-middle"),children:[t&&(0,n.jsxs)("div",{className:"divider flex items-center justify-between px-5 py-3.5",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 font-bold",children:[s,(0,n.jsx)("div",{children:t})]}),v?(0,n.jsx)("button",{type:"button",className:"rounded-full p-1 text-gray-800 hover:bg-gray-200 dark:text-gray-100 dark:hover:bg-gray-500",onClick:v,children:(0,n.jsx)(l.Z,{className:"h-5 w-5"})}):null]}),u]})})]})})})}},67946:function(e,s,t){"use strict";var n,r,a,l,i,o,d,c;t.d(s,{As:function(){return n},Es:function(){return a},T0:function(){return l}}),(i=n||(n={})).NewPost="NEW_POST",i.NewComment="NEW_COMMENT",(o=r||(r={})).All="ALL",o.Mentions="MENTIONS",o.Comments="COMMENTS",o.Likes="LIKES",o.Collects="COLLECTS",(d=a||(a={})).Feed="FEED",d.Replies="REPLIES",d.Media="MEDIA",d.Collects="COLLECTS",d.Nft="NFT",d.Subscribers="SUBSCRIBERS",d.Superfluid="SUBSCRIBERSFEED",(c=l||(l={})).All="All",c.Lens="Lens",c.Other="Other",c.Requests="Requests"},43799:function(e,s,t){"use strict";t.d(s,{I:function(){return a},M:function(){return l}});var n=t(5649);let r=/^(.*)\/lens\.dev\/dm\/(.*)-(.*)$/,a=(e,s)=>s?"".concat(e.toLowerCase(),"/").concat(s):e.toLowerCase(),l=e=>{let s=e.match(r);if(!s||4!==s.length)return{peerAddress:e,members:[]};let[,t,a,l]=Array.from(s);return{peerAddress:t,members:[a,l],conversationId:"".concat(n.Yg,"/").concat(a,"-").concat(l)}}},41741:function(e,s,t){"use strict";var n,r;t.d(s,{D:function(){return n}}),(r=n||(n={})).SomethingWentWrong="Something went wrong!",r.SignWallet="Please sign in your wallet.",r.InvalidAccesstoken="InvalidAccesstoken"},622:function(e,s){"use strict";let t=e=>null==e?void 0:e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");s.Z=t},4108:function(e,s,t){"use strict";var n=t(622);s.Z=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}].reverse().find(function(s){return e>=s.value});return t?e<1e4?(0,n.Z)(e):(e/t.value).toFixed(s).replace(/\.0+$|(\.\d*[1-9])0+$/,"$1")+t.symbol:"0"}},66949:function(e,s,t){"use strict";t.d(s,{x:function(){return m},F:function(){return u}});var n=t(51039),r=t(67294),a=t(92882),l=t(49520);class i extends l.default{async persistPreviewMessage(e){let{conversationKey:s,myProfileId:t,sent:n}=e;await this.previewMessages.put(e,[s,t,n])}async persistProfile(e){let{myProfileId:s,conversationKey:t}=e;await this.lensProfiles.put(e,[s,t])}constructor(){super("messageDb"),this.version(1).stores({previewMessages:"conversationKey, myProfileId, sent",lensProfiles:"[myProfileId+conversationKey], myProfileId"})}}let o=new i,d=(e,s,t)=>({conversationKey:e,myProfileId:s,sent:t.sent,messageBytes:t.toBytes()}),c=e=>{if(!e)throw Error("No profile id")},u=()=>{let e=(0,a.qr)(e=>e.currentProfile),s=(0,r.useCallback)(async s=>{let t=null==e?void 0:e.id;c(t),await o.transaction("rw",o.previewMessages,async()=>{for(let[t,n]of s.entries()){let r=d(t,null==e?void 0:e.id,n);await o.persistPreviewMessage(r)}})},[e]),t=(0,r.useCallback)(async(s,t)=>{let n=null==e?void 0:e.id;c(n);let r=d(s,n,t);await o.persistPreviewMessage(r)},[e]),l=(0,r.useCallback)(async s=>{let t=null==e?void 0:e.id;c(t),await o.transaction("rw",o.lensProfiles,async()=>{for(let[e,n]of s.entries()){let r={...n,myProfileId:t,conversationKey:e};await o.persistProfile(r)}})},[e]),i=(0,r.useCallback)(async(s,t)=>{let n=null==e?void 0:e.id;c(n);let r={...t,myProfileId:n,conversationKey:s};await o.persistProfile(r)},[e]),u=(0,n.useLiveQuery)(async()=>{if(e)return o.previewMessages.where("myProfileId").equals(e.id).sortBy("sent")},[e]),m=(0,n.useLiveQuery)(async()=>{if(!e)return;let s=await o.lensProfiles.where("myProfileId").equals(e.id).sortBy("name");return new Map(s.map(e=>[e.conversationKey,e]))},[e]);return{persistPreviewMessage:t,batchPersistPreviewMessages:s,batchPersistProfiles:l,persistProfile:i,previewMessages:u,messageProfiles:m}},m=(e,s)=>{let t=(0,n.useLiveQuery)(()=>{if(e)return o.lensProfiles.get([e,s])},[e,s]);return{profile:t}}},50680:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var n=t(85893),r=t(29780),a=t(9008),l=t.n(a),i=t(41664),o=t.n(i);t(67294);var d=t(5649);function c(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l(),{children:(0,n.jsx)("title",{children:"404"})}),(0,n.jsxs)("div",{className:"mt-10 flex h-full flex-col items-center justify-start md:mt-20",children:[(0,n.jsx)("img",{src:"".concat(d.Fv,"/images/icon.png"),alt:d.iC,draggable:!1,height:200,width:200}),(0,n.jsxs)("div",{className:"py-10 text-center",children:[(0,n.jsx)("h1",{className:"mb-4 text-3xl font-bold",children:"404"}),(0,n.jsx)("div",{className:"mb-6",children:"This page could not be found."}),(0,n.jsx)(o(),{href:"/",children:(0,n.jsx)(r.z,{children:"Go Home"})})]})]})]})}},10116:function(e,s,t){"use strict";t.d(s,{N:function(){return c},G:function(){return d}});let n=e=>{let s=[...Array.from(new Map(e.map(e=>[e.id,e])).values())];return s.sort((e,s)=>{var t,n,r,a;return(null!==(r=null===(t=s.sent)||void 0===t?void 0:t.getTime())&&void 0!==r?r:0)-(null!==(a=null===(n=e.sent)||void 0===n?void 0:n.getTime())&&void 0!==a?a:0)}),null!=s?s:[]};var r=t(1257),a=t(73445),l=t(782),i=t(45341),o=t(5649);let d=(0,a.Ue)(e=>({client:void 0,setClient:s=>e(()=>({client:s})),conversations:new Map,setConversations:s=>e(()=>({conversations:s})),addConversation:(s,t)=>{e(e=>{let n=new Map(e.conversations);return n.set(s,t),{conversations:n}})},chatProvider:o.N5.PUSH,setChatProvider:s=>e(()=>({chatProvider:s})),queuedMessages:new Map,addQueuedMessage:(s,t)=>{e(e=>{let n=new Map(e.queuedMessages),r=e.queuedMessages.get(s)||[],a=[...r,t];return a.sort((e,s)=>s.sent.getTime()-e.sent.getTime()),n.set(s,a),{queuedMessages:n}})},removeQueuedMessage:(s,t)=>{e(e=>{let n=new Map(e.queuedMessages),r=e.queuedMessages.get(s)||[],a=r.filter(e=>e.id!==t);return n.set(s,a),{queuedMessages:n}})},updateQueuedMessage:(s,t,n)=>{e(e=>{let r=new Map(e.queuedMessages),a=e.queuedMessages.get(s)||[],l=a.filter(e=>e.id!==t);return a.length!==l.length?(l.push(n),l.sort((e,s)=>s.sent.getTime()-e.sent.getTime()),r.set(s,l),{queuedMessages:r}):{queuedMessages:e.queuedMessages}})},messages:new Map,addMessages:(s,t)=>{let r=0;return e(e=>{let a=new Map(e.messages),l=e.messages.get(s)||[],i=n([...l,...t]);return(r=i.length-l.length)?(a.set(s,i),{messages:a}):{messages:e.messages}}),r},hasSyncedMessages:!1,setHasSyncedMessages:s=>e(()=>({hasSyncedMessages:s})),previewMessages:new Map,setPreviewMessages:s=>e(()=>({previewMessages:s})),ensNames:new Map,setEnsNames:s=>e(()=>({ensNames:s})),previewMessagesNonLens:new Map,setPreviewMessagesNonLens:s=>e(()=>({previewMessagesNonLens:s})),selectedProfileId:"",setSelectedProfileId:s=>e(()=>({selectedProfileId:s})),selectedTab:"All",setSelectedTab:s=>e(()=>({selectedTab:s})),syncedProfiles:new Set,addSyncedProfiles:s=>e(e=>{let{syncedProfiles:t}=e;return{syncedProfiles:new Set([...t,...s])}}),unsyncProfile:s=>e(e=>{let{syncedProfiles:t}=e;return{syncedProfiles:new Set([...t].filter(e=>e!==s))}}),reset:()=>e(e=>({...e,conversations:new Map,messages:new Map,messageProfiles:new Map,previewMessages:new Map,selectedTab:"All",previewMessagesNonLens:new Map,ensNames:new Map}))})),c=(0,a.Ue)((0,l.tJ)(e=>({viewedMessagesAtNs:new Map,showMessagesBadge:new Map,setShowMessagesBadge:s=>e(()=>({showMessagesBadge:s})),clearMessagesBadge:s=>{e(e=>{let t=new Map(e.viewedMessagesAtNs);if(t.set(s,(0,r.$)(new Date)),!e.showMessagesBadge.get(s))return{viewedMessagesAtNs:t};let n=new Map(e.showMessagesBadge);return n.set(s,!1),{viewedMessagesAtNs:t,showMessagesBadge:n}})},unsentMessages:new Map,setUnsentMessage:(s,t)=>e(e=>{let n=new Map(e.unsentMessages);return t?n.set(s,t):n.delete(s),{unsentMessages:n}}),setUnsentMessages:s=>e(()=>({unsentMessages:s}))}),{name:i.d.MessageStore,storage:{setItem(e,s){let t=JSON.stringify({...s,state:{...s.state,viewedMessagesAtNs:Array.from(s.state.viewedMessagesAtNs),showMessagesBadge:Array.from(s.state.showMessagesBadge),unsentMessages:Array.from(s.state.unsentMessages)}});localStorage.setItem(e,t)},getItem:e=>{let s=localStorage.getItem(e);if(!s)return null;let t=JSON.parse(s);return t.state.viewedMessagesAtNs=new Map(t.state.viewedMessagesAtNs),t.state.showMessagesBadge=new Map(t.state.showMessagesBadge),t.state.unsentMessages=new Map(t.state.unsentMessages),t},removeItem(e){localStorage.removeItem(e)}}}))},91648:function(e,s,t){"use strict";var n=t(5649);let r=(e,s)=>{let t=parseInt(e.substring(2),16),r=parseInt(s.substring(2),16);return t<r?"".concat(n.Yg,"/").concat(e,"-").concat(s):"".concat(n.Yg,"/").concat(s,"-").concat(e)};s.Z=r},81137:function(e,s,t){"use strict";var n=t(5649);let r=e=>{if(!e)return"";let s=n.sU;return e.match(s)?"".concat(e.slice(0,4),"…").concat(e.slice(e.length-4,e.length)):e};s.Z=r},86913:function(e,s,t){"use strict";var n=t(67294);let r=(e,s)=>{(0,n.useEffect)(()=>{let t=t=>{let n=null==e?void 0:e.current;!n||n.contains(t.target)||s(t)};return document.addEventListener("mousedown",t),document.addEventListener("touchstart",t),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("touchstart",t)}},[e,s])};s.Z=r},14382:function(e,s,t){"use strict";t.d(s,{T:function(){return h}});var n=t(45341),r=t(5649),a=t(1257),l=t(67294),i=t(92882),o=t(10116),d=t(88559),c=t(52942),u=t(48764).Buffer;let m="binary",v=e=>"xmtp:".concat(r.Jy,":keys:").concat(e),f=e=>{let s=localStorage.getItem(v(e));return s?u.from(s,m):null},g=(e,s)=>{localStorage.setItem(v(e),u.from(s).toString(m))},x=e=>{localStorage.removeItem(v(e))},h=()=>{let{data:e}=(0,c.Z)(),s=(0,o.G)(e=>e.client),t=(0,o.G)(e=>e.setClient),r=(0,l.useCallback)(async()=>{e&&x(await e.getAddress()),s&&t(void 0),localStorage.removeItem(n.d.MessageStore),localStorage.removeItem(n.d.AttachmentCache),localStorage.removeItem(n.d.AttachmentStore)},[e,s]);return r};s.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=(0,i.qr)(e=>e.currentProfile),t=(0,o.G)(e=>e.client),n=(0,o.G)(e=>e.setClient),[u,m]=(0,l.useState)(),{data:v,isLoading:x}=(0,c.Z)();return(0,l.useEffect)(()=>{let l=async()=>{if(v&&!t&&s){let l=f(await v.getAddress());if(!l){if(e)return;m(!0),l=await a.KU.getKeys(v,{env:r.Jy,appVersion:r.iC+"/"+r.Ji,persistConversations:!1,skipContactPublishing:!0}),g(await v.getAddress(),l)}let i=await a.KU.create(null,{env:r.Jy,appVersion:r.iC+"/"+r.Ji,privateKeyOverride:l,persistConversations:!0});i.registerCodec(new d.AttachmentCodec),i.registerCodec(new d.RemoteAttachmentCodec),n(i),m(!1)}else m(!1)};l(),v&&s||n(void 0)},[s]),{client:t,loading:x||u}}},95856:function(){}}]);